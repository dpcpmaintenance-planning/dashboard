<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Narra Thermal 1</title>
    <link rel="icon" type="image/png" href="../DMCIlogo.png" />

    <!-- Core Styles -->
    <link rel="stylesheet" href="systeminfo.css" />
    <link rel="stylesheet" href="../header.css" />
    <link rel="stylesheet" href="../footer.css" />
    <link rel="stylesheet" href="../mobile.css" />

    <!-- TomSelect -->
    <link
      href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/js/tom-select.complete.min.js"></script>

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  </head>

  <body>
    <!-- Header -->
    <header id="main-header"></header>

    <!-- Page Title -->
    <h1 class="page-title">Narra Thermal 1 Equipment Information</h1>

    <!-- Tabs -->
    <nav id="tabs-container" class="tabs" aria-label="System Tabs"></nav>

    <!-- Diagram / Equipment List -->
    <section
      id="diagram"
      class="diagram-container"
      aria-live="polite"
    ></section>

    <!-- PDF Modal -->
    <div id="pdf-modal" class="modal hidden" aria-hidden="true">
      <div class="modal-content">
        <!-- Close Button -->
        <button id="pdf-modal-close" class="close" aria-label="Close PDF">
          âœ–
        </button>

        <!-- PDF Frame (Full Screen) -->
        <div class="pdf-container">
          <iframe
            id="pdf-frame"
            src=""
            title="PDF Viewer"
            frameborder="0"
            allowfullscreen
          ></iframe>
        </div>
      </div>
    </div>

    <!-- Last Updated -->
    <div id="last-updated" class="last-updated-text"></div>

    <!-- Footer -->
    <footer id="main-footer" class="footer"></footer>

    <!-- Scripts -->
    <script src="javascript/config.js"></script>
    <script src="javascript/diagram.js"></script>
    <script src="javascript/data.js"></script>
    <script src="javascript/main.js"></script>
    <script src="../js/header.js"></script>

    <script>
      const tabs = [
        ["bottom-ash", "Bottom Ash System"],
        ["combustion", "Combustion System"],
        ["wts", "Water Treatment"],
        ["sws", "Steam and Water"],
        ["sccws", "Seawater & CCW"],
        ["cbhs", "Coal & Biomass Handling"],
        ["cas", "Compressed Air"],
        ["fps", "Fire Protection"],
        ["tls", "Turbine Lubrication"],
        ["cs", "Chlorination System"],
        ["electrical", "MV & LV Electrical"],
        ["substation", "Substation"],
        ["heavy-equipment", "Heavy Equipment"],
        ["switchyard", "Switchyard"],
        ["le", "Lifting Equipment"],
      ];

      document.addEventListener("DOMContentLoaded", () => {
        const container = document.getElementById("tabs-container");
        container.innerHTML = tabs
          .map(
            ([id, label], i) =>
              `<button class="tab-button${
                i === 0 ? " active" : ""
              }" data-tab="${id}">${label}</button>`
          )
          .join("");

        // Show default tab content on page load
        showTab(null, "bottom-ash");

        container.addEventListener("click", (e) => {
          if (e.target.classList.contains("tab-button")) {
            showTab(e, e.target.dataset.tab);
          }
        });

        // Modal handling
        const pdfModal = document.getElementById("pdf-modal");
        const pdfCloseBtn = document.getElementById("pdf-modal-close");
        const pdfFrame = document.getElementById("pdf-frame");

        pdfCloseBtn.addEventListener("click", () => {
          pdfModal.classList.add("hidden");
          pdfModal.classList.remove("active");
          pdfModal.setAttribute("aria-hidden", "true");
          pdfFrame.src = ""; // reset for next open
        });

        pdfModal.addEventListener("click", (e) => {
          if (e.target === pdfModal) {
            pdfModal.classList.add("hidden");
            pdfModal.classList.remove("active");
            pdfModal.setAttribute("aria-hidden", "true");
            pdfFrame.src = "";
          }
        });
      });
    </script>
  </body>
</html>
